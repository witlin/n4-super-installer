<!DOCTYPE html>
<html>
<head>
<title>README.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<!-- Bootstrap CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
<link rel="stylesheet" href="assets/readme/readme.css">
<h1 id="n4-super-installer">n4-super-installer</h1>
<p>This powershell script automates portions of the installation process for an N4 Supervisor.</p>
<h2 id="directions-of-use">Directions of use</h2>
<ol>
<li>Open a Remote Desktop Connection with the server<br>
<img src="assets/readme/rdp.png" alt="rdp prompt"><br><br></li>
<li>Copy and paste the <em>n4-super-installer</em> zip file from your computer to the server.
<img src="assets/readme/copy.png" alt="copy zip file"><br><br></li>
<li>Unzip the installer on your Windows user's desktop.
<img src="assets/readme/unzip.png" alt="unzip folder"><br><br></li>
<li>Open the Windows Start Menu and type <em>powershell</em>, then select Run As Administrator
<img src="assets/readme/start-menu-ps.png" alt="start menu powershell selection"><br><br></li>
<li>Copy the code below, and paste it on the Powershell blue command prompt:</li>
</ol>
<pre class="hljs"><code><div>cd <span class="hljs-string">"<span class="hljs-variable">$env:homedrive</span><span class="hljs-variable">$env:homepath</span>\Desktop\n4-super-installer"</span>;
<span class="hljs-built_in">Set-ExecutionPolicy</span> Bypass <span class="hljs-literal">-Scope</span> <span class="hljs-keyword">Process</span> <span class="hljs-literal">-Force</span>; .\scripts\installer.ps1
</div></code></pre>
<ol start="7">
<li>Press <strong>Enter</strong> and wait to follow the prompts for the software installation setups, which will be installed in sequential order. At this point the installer has created the <em>D:\Controls Software</em> folder and copied all the contents from the current download folder to the folder where application installers will be kept.<br><br></li>
<li>After all the setups are done the installer will copy the jars into the modules directory, it will copy the license file into its proper folder, and copy the start menu shortcut folders from the installation user directory to the allusersprofile start menu shortcut directory.
<img src="assets/readme/gfx-auto-installer.png" alt="gfx-auto-installer"><br><br>
<img src="assets/readme/n4-ec-net-auto-installer.png" alt="n4-ec-net-auto-installer"><br><br>
<img src="assets/readme/ec-net-license-check.png" alt="ec-net-license-check"><br><br>
<img src="assets/readme/support-pack-installer-0.png" alt="support-pack-installer-0"><br><br>
<img src="assets/readme/productivity-tools-setup-1.png" alt="productivity-tools-setup-1"><br><br>
<img src="assets/readme/support-pack-installer-6.png" alt="support-pack-installer-6"><br><br>
<img src="assets/readme/file-auto-scaffold.png" alt="file-auto-scaffold"><br><br></li>
<li>The Support Pack needs the .NET Framework version 2.0 to be installed, the installer runs local, but it still requires internet access to Microsoft Services.<br><br></li>
<li>The nre.properties gets edited to allocate more memory in the JVM, then the file gets copied from the Niagara default installation folders over to <code>C:\ProgramData\Niagara4.9\distech\etc</code> and <code>C:\Users\User\Niagara4.9\distech\etc</code>; a copy of the original unedited version of the nre.properties file gets archived in case it is needed.</li>
</ol>
<h2 id="engineering-notes">Engineering Notes</h2>
<blockquote>
<p>In eventvwr.msc, we are looking for the process-creation (4688) and process-terminations (4689) events in the Windows event viewer to track the overall install process</p>
</blockquote>
<p><br>The expected output in the event viewer for each setup.exe program this installer runs should look like this:</p>
<table>
<thead>
<tr>
<th>Keywords</th>
<th>Date and Time</th>
<th>Source</th>
<th>Event ID</th>
<th>Task Category</th>
</tr>
</thead>
<tbody>
<tr>
<td>Audit Success</td>
<td>12/1/2020 12:44:21 PM</td>
<td>Microsoft Windows security auditing.</td>
<td>4688</td>
<td>Process Creation</td>
</tr>
<tr>
<td>Audit Success</td>
<td>12/1/2020 12:44:21 PM</td>
<td>Microsoft Windows security auditing.</td>
<td>4688</td>
<td>Process Creation</td>
</tr>
</tbody>
</table>
<br>
followed by:<br>
<table>
<thead>
<tr>
<th>Keywords</th>
<th>Date and Time</th>
<th>Source</th>
<th>Event ID</th>
<th>Task Category</th>
</tr>
</thead>
<tbody>
<tr>
<td>Audit Success</td>
<td>12/1/2020 12:48:37 PM</td>
<td>Microsoft Windows security auditing.</td>
<td>4688</td>
<td>Process Termination</td>
</tr>
<tr>
<td>Audit Success</td>
<td>12/1/2020 12:49:12 PM</td>
<td>Microsoft Windows security auditing.</td>
<td>4688</td>
<td>Process Termination</td>
</tr>
</tbody>
</table>
<p><strong>full event log details</strong></p>
<pre class="hljs"><code><div>Log Name:      Security
Source:        Microsoft-Windows-Security-Auditing
Date:          12/1/2020 12:44:21 PM
Event ID:      4688
Task Category: Process Creation
Level:         Information
Keywords:      Audit Success
User:          N/A
Computer:      WinDev2010Eval
Description:
A new process has been created.

Creator Subject:
	Security ID:		S-1-5-21-3858184157-4174427647-2357676267-1001
	Account Name:		User
	Account Domain:		WINDEV2010EVAL
	Logon ID:		0x31F70

Target Subject:
	Security ID:		S-1-0-0
	Account Name:		-
	Account Domain:		-
	Logon ID:		0x0

Process Information:
	New Process ID:		0x249c
	New Process Name:	C:\Users\User\AppData\Local\Temp\is-NVBLR.tmp\Distech Controls EC-gfxProgram v6.6.20212 Setup.tmp
	Token Elevation Type:	%%1937
	Mandatory Label:		S-1-16-12288
	Creator Process ID:	0x26c0
	Creator Process Name:	C:\Users\User\projects\n4-super-installer\assets\installers\Distech Controls EC-gfxProgram v6.6.20212 Setup.exe
</div></code></pre>
<br>
<pre class="hljs"><code><div>Log Name:      Security
Source:        Microsoft-Windows-Security-Auditing
Date:          12/1/2020 12:44:21 PM
Event ID:      4688
Task Category: Process Creation
Level:         Information
Keywords:      Audit Success
User:          N/A
Computer:      WinDev2010Eval
Description:
A new process has been created.

Creator Subject:
	Security ID:		S-1-5-21-3858184157-4174427647-2357676267-1001
	Account Name:		User
	Account Domain:		WINDEV2010EVAL
	Logon ID:		0x31F70

Target Subject:
	Security ID:		S-1-0-0
	Account Name:		-
	Account Domain:		-
	Logon ID:		0x0

Process Information:
	New Process ID:		0x26c0
	New Process Name:	C:\Users\User\projects\n4-super-installer\assets\installers\Distech Controls EC-gfxProgram v6.6.20212 Setup.exe
	Token Elevation Type:	%%1937
	Mandatory Label:		S-1-16-12288
	Creator Process ID:	0x6fc
	Creator Process Name:	C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
</div></code></pre>
<blockquote>
<p>Command References<br>
secpol.msc<br>
eventvwr.msc <br></p>
</blockquote>
<pre class="hljs"><code><div><span class="hljs-built_in">clear-eventlog</span> <span class="hljs-literal">-logname</span> Security <span class="hljs-literal">-computername</span> (<span class="hljs-variable">$env:COMPUTERNAME</span>)
</div></code></pre>

</body>
</html>
